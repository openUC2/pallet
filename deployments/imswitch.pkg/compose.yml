services:
  imswitch-noqt:
    image: ghcr.io/openuc2/imswitch-noqt:sha-86a6521@sha256:b4addd7042c5af77dfb4c1ed60e053eaf15a7cf9ec5f20266e587392baa19e6d
    privileged: true
    ports:
      - "8001:8001" # frontend, HTTP API, WebSockets API
      - "8888:8888" # Jupyter
    volumes:
      - /etc/machine-id:/etc/machine-id:ro
      - /home/pi/ImSwitchConfig:/config
      - /home/pi/Datasets:/datasets
      - /media:/media
    environment:
      - HEADLESS=1
      - HTTP_PORT=8001
      - CONFIG_PATH=/config
      - CONFIG_FILE=example_virtual_microscope.json
      - UPDATE_GIT=0
      - UPDATE_CONFIG=0
      - DATA_PATH=/datasets
      - SCAN_EXT_DRIVE_MOUNT=1 # parsed by entrypoint.sh, which ignores SCAN_EXT_DATA_FOLDER
      - EXT_DRIVE_MOUNT=/media/pi
      - SSL=0
    restart: always
