package:
  description: Microscope control server
  maintainers:
    - name: Ethan Li
      email: lietk12@gmail.com
    - name: Benedict Diederich
      email: benedictdied@gmail.com
  license: GPL-3.0-only
  sources:
    - https://github.com/ImSwitch/ImSwitch

deployment:
  compose-files: [compose.yml]

features:
  firewall-allow-direct:
    description:
      Firewall configuration to allow requests from directly-connected devices
    requires:
      filesets:
        - description: Drop-in directory for XML fragment files to generate the nm-shared zone definition
          tags:
            - drop-in-assembly
          paths:
            - /etc/firewalld/zones.d/nm-shared
    provides:
      file-exports:
        - description: Definition for firewalld's imswitch service
          target: overlays/etc/firewalld/services/imswitch.xml
        - description: Drop-in XML fragment for firewalld's imswitch service
          target: overlays/etc/firewalld/zones.d/nm-shared/70-service-imswitch.xml
  firewall-allow-public:
    description:
      Firewall configuration to allow public requests
    requires:
      filesets:
        - description: Drop-in directory for XML fragment files to generate the public zone definition
          tags:
            - drop-in-assembly
          paths:
            - /etc/firewalld/zones.d/public
    provides:
      file-exports:
        - description: Definition for firewalld's imswitch service
          target: overlays/etc/firewalld/services/imswitch.xml
        - description: Drop-in XML fragment for firewalld's imswitch service
          target: overlays/etc/firewalld/zones.d/public/70-service-imswitch.xml

  dev-edge:
    description: >-
      Uses the `edge` tag for the ImSwitch docker container image, for faster development
      iteration but no build reproducibility
    compose-files:
      - dev-edge.yml
